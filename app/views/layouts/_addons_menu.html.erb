<script type="text/javascript">
    addons_menu = new dTree('addons_menu');
    addons_menu.config.inOrder = true;
    <% if erp_active? or skp_active? or ad_active? or cc_active? or call_shop_active? or (rec_active?) or reseller_active? or (sms_active?)or (defined?(MA_Active) and MA_Active == 1) or (defined?(PG_Active) and PG_Active == 1) or provider_billing_active? or web_phone_active? %>

    <% si = 0
    i = si %>
    addons_menu.add(<%= i %>, -1, '<%= _('ADDONS') %>');
    <% i += 1 %>


    <% if ad_active? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Auto_Dialer') %>', '<%= Web_Dir %>/autodialer/campaigns');
    <% i += 1 %>
    <% end %>

    <% if cc_active?%>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Calling_cards') %>', '<%= Web_Dir %>/cardgroups/list');
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-1 %>, '<%= _('Cardgroup_Stats') %>', '<%= Web_Dir %>/cardgroups/cardgroups_stats');
    <% i += 1 %>
    <% if admin? or accountant? %>
    addons_menu.add(<%= i %>, <%= i-2 %>, '<%= _('Cardgroup_Aggregate') %>', '<%= Web_Dir %>/cardgroups/aggregate');
    <% i += 1 %>
    <% end %>
    <% end %>

    <% if call_shop_active? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Call_shop') %>', '<%= Web_Dir %>/groups/list');
    <% i += 1 %>
    <% end %>

    <% if reseller_active? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Resellers') %>', '<%= Web_Dir %>/stats/resellers');
    <% i += 1 %>
    <%if reseller_pro_active?%>
    addons_menu.add(<%= i %>, <%= i-1 %>, '<%= _('Common_use_providers') %>', '<%= Web_Dir %>/common_use_providers');
    <%end%>
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-2 %>, '<%= _('Settings') %>', '<%= Web_Dir %>/resellers/settings');
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-3 %>, '<%= _('Reseller_permissions') %>', '<%= Web_Dir %>/permissions/list?group_type=reseller');
    <% i += 1 %>
    <% end %>

    <% if sms_active?%>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('SMS') %>', '<%= Web_Dir %>/sms/users');
    <% i += 1 -%>
    <% a = i-1 -%>
    addons_menu.add(<%= i %>, <%= a %>, '<%= _('Tariffs') %>', '<%= Web_Dir %>/sms/tariffs');
    <% i += 1 -%>
    addons_menu.add(<%= i %>, <%= a %>, '<%= _('Providers') %>', '<%= Web_Dir %>/sms/providers');
    <% i += 1 -%>
    addons_menu.add(<%= i %>, <%= a %>, '<%= _('Lcr') %>', '<%= Web_Dir %>/sms/lcrs');
    <% i += 1 -%>
    <% end %>

    <% if rec_active? %>
    <% if show_recordings? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Recordings') %>', '<%= Web_Dir %>/recordings/recordings', '', '', '<%= Web_Dir %>/assets/dtree/musicfolder.gif', '<%= Web_Dir %>/assets/dtree/musicfolder.gif');
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-1 %>, '<%= _('users') %>', '<%= Web_Dir %>/recordings/list_users');
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-2 %>, '<%= _('Bulk_management') %>', '<%= Web_Dir %>/recordings/bulk_management');
    <% i += 1 %>
    <% end %>
    <% end %>

    <% if gateways_enabled_for(current_user) %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Payment_Gateways') %>', '<%= Web_Dir %>/payment_gateways/configuration');
    <% i += 1 %>
    <% end %>
    <% if monitoring_enabled_for(current_user) %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Monitorings') %>', '<%= Web_Dir %>/monitorings');
    <% i += 1 %>
    addons_menu.add(<%= i %>, <%= i-1 %>, '<%= _('Settings') %>', '<%= Web_Dir %>/monitorings/settings');
    <% i += 1 %>
    <% end %>

    <% if skp_active?%>
    <% if admin? or accountant? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Skype') %>', '<%= Web_Dir %>/functions/skype');
    <% i += 1 %>
    <% end %>
    <% end %>

    <% if callback_active?%>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Callback') %>', '<%= Web_Dir %>/functions/callback_settings');
    <% i += 1 %>
    <% end %>

    <% end %>

    <% if erp_active?%>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('ERP') %>', <%= Confline.valid_erp_settings?(current_user.id) ? "'javascript:document.erp_login.submit();'" : "'#{Web_Dir}/erp/settings'" %>)
    <% i += 1 %>
    <% a = i-1 -%>
    addons_menu.add(<%= i %>, <%= a %>, '<%= _('Settings') %>', '<%= Web_Dir %>/erp/settings');
    <% i += 1 %>
    <% end %>
    <% if provider_billing_active? %>
      addons_menu.add(<%= i %>, <%= si %>, '<%= _('Provider_billing') %>', '<%= Web_Dir %>/providers/billing');
      <% i += 1 %>
    <% end %>

    <% if web_phone_active? %>
    addons_menu.add(<%= i %>, <%= si %>, '<%= _('Webphone') %>', '<%= Web_Dir %>/functions/webphone_settings');
    <% i += 1 %>
    <% end %>

    $("addons_menu_div").innerHTML = addons_menu.toString();
</script>
